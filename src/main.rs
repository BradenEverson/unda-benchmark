use std::time::Instant;

use unda::core::network::Network;

fn main() {
    let model_str = "D|64|3|1.5163358 -0.9926614 -0.011606119 -2.340206 -3.9556887 0.7453673 -0.6786287 1.2121098 -0.74576646 -1.2036068 -2.0264175 1.2674333 0.21374644 0.68617237 0.45213518 6.142648 -0.63946307 -1.7355224 -0.9045165 1.7856479 -0.67171305 -0.08492566 0.44649765 0.42816517 0.107269414 1.1055712 -1.0352331 -0.3879355 3.331783 -1.2181826 0.2935653 1.5802265 -0.7441019 1.2571166 1.3227671 1.060724 -0.4444827 -0.09795006 -0.77989036 0.57973146 0.122518785 -2.3082325 3.1020267 -0.8649502 1.2786387 3.172839 0.23415585 0.8669769 0.94436675 -1.1992266 2.0106456 -0.24598177 3.4932256 0.38826573 0.8100602 -0.76708686 0.17363879 -2.3216777 -1.3598413 -2.3824348 0.6179936 -0.487695 -1.9983425 -1.6107675 2.3265269 -3.3491466 -1.1755089 -1.1696956 -0.2126834 0.54439396 -0.24627359 -1.3736765 -0.2542177 3.4582012 -1.4761797 2.2819555 2.6275373 -1.335855 0.9936165 2.7474132 -1.1088673 2.9189575 -2.5388165 -3.4398472 -0.64414394 -0.946967 -1.4680008 2.4748933 -2.8375757 1.7308611 1.4125968 -1.0374876 -0.010149432 -0.8187597 1.5234795 0.90683836 1.7881148 2.0969927 -0.81918746 -2.0308013 -3.314829 1.5881735 0.5538766 -1.079091 -0.15115502 1.4573869 1.1187514 1.5033147 -2.893711 -0.87712705 1.3982902 4.360546 -0.16046509 -0.3847699 -1.1638029 -1.9416794 -4.1479716 1.1082089 -1.6288078 -0.41618073 -2.267948 -0.65298545 -2.6315513 -0.8492466 -1.7877401 -2.582688 -0.14396338 -0.71392924 -1.2372776 -0.32262632 1.1228781 -0.3489231 -0.59966636 1.7007947 -2.9686131 0.969334 0.7574818 -0.68606204 1.4391913 -2.261051 2.9944046 0.040194865 -1.2932167 0.35530472 2.8202379 1.6607957 0.5470314 -0.7061272 -1.4125144 0.16187967 -2.7909136 1.701256 -0.24585204 -0.4923803 -0.4090811 -2.0800645 -2.6492846 -1.5820122 2.127507 -0.9518524 0.61607116 -1.3803824 0.3423361 0.2739081 0.8748544 0.44412887 -0.23319052 -0.97601986 1.2311748 1.8767753 1.9681039 -3.0614178 -0.21858636 2.734969 -1.2585744 2.6187637 0.3756862 0.48173612 -0.9535568 1.8519856 -2.8282468 0.7061085 -1.5136935 -1.7138573 -0.7884962 -0.6465239 -5.9390955 -0.34364104 0.14577526 -0.26868564 -2.0604482 -4.295371|0.33683872 0.34304285 0.70783234 0.081712246 -0.6793966 0.6873741 0.46132421 0.05975437 0.5220816 -0.62234354 -0.6487324 -0.5051329 0.27267647 0.15628862 -0.7619903 -0.31535125 -0.9000766 -0.7982614 0.58231235 -0.5568862 -0.97175145 -0.13069582 0.9285741 -0.6612289 0.47991967 0.8931346 -0.7659602 -0.6423631 0.0015628338 -0.58488536 0.369972 -0.4742744 0.4452989 0.4786427 -0.8618767 0.6589868 0.550159 0.9206431 -0.37420797 0.5885899 0.7306466 0.5804405 0.1001122 -0.88422894 0.3194523 -0.6792555 0.83080673 -0.7010145 0.6828077 -0.37070656 -0.25512815 0.5614035 0.5371506 0.18701315 -0.032848835 -0.6212456 0.88205934 0.37847018 0.45104837 -0.11505222 -0.42301345 0.45877147 0.8512144 -0.7450149#D|16|64|-440.0173 3033.5217 -3952.8286 2424.6152 -2196.4658 -1237.9615 -4604.995 -1892.4148 -3960.6973 -7502.6987 -5283.2437 -1895.8983 -2827.7014 -5193.1123 -15.376768 -1310.8068 1859.6416 -4375.153 -727.3047 -2838.7017 -4301.9756 -9718.626 -547.16864 -3574.179 -5206.748 -2649.6528 -5767.944 -2733.4517 -2444.8103 2790.3118 -384.41446 -2840.074 -2816.3281 3483.534 386.56735 -1686.8864 86.55254 -1525.3594 -4148.3955 174.02998 -4101.491 -2646.1753 -2398.871 -4826.822 -8203.818 -3669.876 25.90879 1359.2437 -1885.4299 964.34344 -5819.789 -4156.286 1519.5107 -5214.766 -1275.4935 -2868.443 -1737.2175 384.05453 -3329.5183 597.27966 -5687.4243 -1712.5775 -2274.3186 -4366.631 162.09093 2089.2566 -2114.033 1738.8481 -1081.8944 -193.29532 -2534.4248 -886.23224 -2054.5532 -4332.2505 -2893.3748 -894.8531 -1350.5967 -2517.187 334.79468 -493.54453 1394.4681 -2388.7017 -73.83167 -917.74005 -1915.6029 -5105.824 -54.973503 -1614.8895 -2816.3748 -1250.0417 -3172.3901 -1301.2031 -961.13947 2071.5566 193.15071 -1570.5808 -1358.3474 2422.3728 608.549 -749.2859 157.71417 -540.9557 -1576.756 568.23425 -1646.1971 -948.22485 -979.62494 -2706.6785 -4277.977 -1810.0132 243.45909 1145.7523 -844.8617 861.87524 -3648.4873 -1890.7018 1105.7655 -2733.758 -514.40234 -1261.4055 -768.6931 400.12833 -1723.9375 587.2566 -2970.1226 -740.96735 -1348.9878 -1733.1923 -545.3744 -4117.846 4371.257 -3778.9058 2029.4745 173.02454 5287.2476 1633.0017 4286.7197 9283.745 6125.3984 1611.5028 2824.0342 5880.542 -1122.7959 689.36304 -3407.251 4960.2476 -65.55717 2805.2927 4690.653 12437.383 -66.75155 3680.5027 5922.805 2432.3096 6683.471 3007.9211 2221.6536 -4898.8823 -613.1194 3026.4724 2684.9778 -4941.9917 -1545.5945 1329.4238 -522.18085 887.33716 4591.737 -1373.0664 4515.2173 2419.2915 2141.8882 5634.079 10133.97 3822.936 -1054.619 -2675.1406 1548.6 -2010.9862 7551.713 4485.683 -2512.2292 6094.5005 793.90314 2743.0417 1396.3557 -1195.2963 3533.6028 -1723.4006 7092.6343 1562.4923 3145.211 4895.3765 -973.423 -1352.8116 -1719.8179 -1169.3584 -1194.7657 -1027.3712 -1766.6686 -1310.353 -1562.7865 -1678.9875 -1515.1469 -1060.6827 -1769.1664 -1692.4883 -658.6735 -985.2309 -549.0134 -1369.6447 -1118.965 -2513.006 -1487.5859 -2911.2598 -1698.9137 -1507.782 -1510.1862 -1293.7375 -1285.946 -527.9535 -2020.3539 -384.39777 -987.7226 -1442.1934 -1250.0996 -1174.3914 -1078.5515 -1240.7462 -1638.7555 -1178.1707 -2152.2153 -1060.2112 -2482.444 -2139.1392 -1763.3461 -1732.7706 -2230.118 -1205.2814 -973.52185 -1103.2904 -1248.7914 -1467.5723 -2449.8403 -2040.2579 -1346.965 -2184.717 -1134.2769 -1461.9208 -1281.5044 -1353.2888 -1534.4423 -893.67664 -2690.8137 -2094.9053 -2103.2212 -1685.7435 -1982.1713 -4125.228 1863.7367 -4214.9414 83.74684 -1529.2411 2643.4421 -269.22607 1796.4371 6230.229 3388.4983 -246.68925 554.83984 3086.8875 -2320.4429 -986.43427 -3941.7476 2540.9102 -1609.0115 817.0815 2196.4333 8769.802 -1600.687 1278.1301 3307.5845 330.75595 4011.579 1397.9382 95.31999 -5059.3784 -2038.9078 908.46875 554.18604 -4982.222 -2769.2056 -515.52606 -1744.5421 -914.3989 2562.768 -2649.8486 2065.0667 412.89728 0.51653194 2915.6091 6690.943 1481.7827 -2231.4014 -3550.6184 -358.93912 -3007.6914 4602.2188 1866.4042 -3258.423 3164.2476 -897.61523 508.41125 -473.59198 -2316.9636 1266.6654 -2738.4268 4177.101 -325.22006 1384.6947 2945.7327 1845.7805 6461.5293 -1515.562 5449.01 -290.25452 1200.6785 -2300.95 314.40683 -1686.8312 -6089.196 -3494.3865 -127.4171 96.12754 -2672.5989 1766.4124 616.7128 3781.8723 -2783.748 1640.9999 1748.2095 -1843.2754 -6405.342 2752.992 -1041.5248 -3332.8228 -478.12552 -4421.8857 -1714.5743 1238.7909 4976.7515 1935.8922 -843.23706 -778.9889 6705.1685 3059.557 486.57144 3104.7861 790.7805 -328.52444 2836.1047 148.69432 1369.3984 804.68964 -2686.2537 -5563.09 -1860.4142 2234.9016 4193.5454 298.07816 4255.2554 -3058.0933 -793.30194 4448.741 -2140.9292 792.72754 -305.24084 505.76993 3071.2122 -1117.3682 2744.4863 -1893.9172 1977.2705 784.1484 -1349.3103 -2156.2285 -4529.6807 2513.9216 -4741.1777 300.40317 -1641.5684 3446.8835 -92.237 2410.8042 7711.236 4288.8564 -109.433525 974.17346 3955.6548 -2598.7786 -991.8195 -4505.864 3191.5574 -1694.8938 1256.6809 2809.0586 10812.495 -1596.9287 1768.9937 4167.741 589.395 4954.581 1667.5885 440.62097 -5851.6 -2216.8955 1305.911 841.8409 -5595.4053 -3044.6929 -387.48267 -1785.4398 -881.7983 3017.6921 -2923.1401 2782.1514 747.8863 310.52393 3763.7214 8341.82 1971.1134 -2441.0469 -3963.7478 -210.27003 -3279.8264 5900.3477 2556.908 -3617.2793 4148.682 -853.1971 864.69025 -328.79327 -2517.3293 1738.4736 -3048.071 5409.892 -16.896517 2106.9937 3358.6667 -2243.9375 -4636.255 2616.8865 -4895.7974 283.45618 -1702.5106 3576.444 -108.67001 2505.6406 7986.511 4437.2847 -138.6065 1045.319 4177.155 -2728.8455 -1056.6519 -4704.2046 3268.4458 -1763.4796 1418.9548 2996.6086 11396.718 -1623.4525 1882.818 4305.4863 601.5814 5109.967 1783.929 530.72314 -6094.3525 -2300.0408 1321.9182 861.97833 -5754.0347 -3145.2017 -410.1942 -1837.1194 -921.509 3218.9365 -3013.8352 3027.2961 860.987 379.92395 3900.625 8785.55 2029.5662 -2564.1362 -4096.6455 -228.946 -3368.4211 6151.726 2745.9314 -3733.0774 4377.4233 -907.2763 926.29034 -345.2414 -2605.5461 1792.9828 -3191.4097 5738.1626 43.371525 2244.7173 3571.0361 -2242.2314 -4675.4243 2611.3088 -4910.5854 287.14243 -1697.2969 3568.5518 -108.05763 2504.2473 7953.7456 4431.0083 -135.3524 1041.3873 4172.949 -2721.6558 -1048.7098 -4716.386 3270.597 -1760.205 1388.2004 2997.7375 11329.068 -1635.031 1888.0444 4294.7754 607.4675 5103.0044 1811.7095 515.5939 -6108.0576 -2299.603 1321.1772 869.0612 -5777.5195 -3148.2832 -409.82172 -1844.9912 -917.1123 3193.6533 -3016.8823 2991.3967 841.5108 371.74994 3899.154 8737.868 2036.5807 -2574.1428 -4106.89 -226.56186 -3383.865 6131.4336 2732.2551 -3745.7268 4359.54 -906.1106 929.7969 -343.23758 -2620.4084 1789.6166 -3195.8572 5705.486 21.401192 2206.863 3544.4607 1876.5071 6607.1816 -1543.8284 5545.947 -304.76807 1227.1466 -2346.4907 310.26813 -1713.2239 -6200.678 -3558.6055 -143.56438 106.16441 -2699.696 1786.5125 620.76447 3831.4902 -2842.3857 1665.9894 1817.2728 -1852.4542 -6474.8286 2807.5063 -1041.7383 -3405.5066 -492.63385 -4504.7163 -1734.5751 1287.6566 5046.9346 1972.0249 -869.585 -796.92914 6834.6494 3112.7268 491.00555 3147.909 805.492 -301.78427 2894.1453 186.40578 1434.8429 835.8699 -2731.854 -5638.27 -1892.244 2255.2866 4271.565 301.98154 4336.877 -3108.7642 -782.32825 4515.6543 -2164.9102 801.32245 -298.13434 509.8396 3102.886 -1144.5059 2776.854 -1907.4658 2025.7826 794.9465 -1343.6606 1823.3595 6182.2505 -1449.1764 5173.6045 -286.3526 1279.165 -2214.4292 293.01324 -1582.9725 -5837.8804 -3323.4065 -121.10056 114.13605 -2476.796 1738.0779 622.80237 3613.6985 -2677.2532 1598.7954 1693.454 -1679.0836 -6176.4546 2627.0947 -920.6621 -3158.8142 -422.5398 -4182.696 -1596.4271 1248.4049 4823.259 1906.1965 -855.11444 -708.65436 6373.3364 2971.3948 474.49576 2864.7776 812.10565 -338.7212 2783.6445 163.2899 1385.9008 835.9483 -2588.6765 -5282.934 -1725.4733 2156.8213 4031.9695 299.07175 4069.0261 -3089.9233 -691.0958 4172.5444 -2037.046 753.2684 -228.88786 490.3491 2890.0112 -1079.2379 2620.464 -1916.8258 1871.1978 520.00446 -1291.8612 1643.7955 5875.005 -1213.1376 4859.0635 -237.5877 1077.8912 -1902.7313 323.31598 -1382.7137 -5265.6196 -2994.5823 -115.117584 243.11966 -2156.0327 1504.8549 536.60815 3245.2256 -2426.5283 1478.195 1873.4647 -1445.606 -5281.4434 2571.5752 -772.0648 -2862.6934 -381.22928 -3862.8455 -1443.3539 1325.9469 4287.6416 1720.2023 -695.08 -656.40564 6009.598 2735.6543 470.08224 2872.517 735.91614 -41.821007 2540.2856 469.27515 1483.2217 891.079 -2248.586 -4616.5005 -1586.8499 1958.357 3737.3154 303.08542 3865.7385 -2448.9502 -447.35947 4000.5122 -1645.7107 715.3327 -146.286 497.92297 2767.0417 -909.30023 2390.263 -1324.3331 1976.1321 976.9384 -988.7554 -496.11176 -4195.108 4566.9385 -3824.0754 2171.9749 269.77695 5507.1353 1758.0464 4469.2876 9590.928 6357.1865 1735.7745 2965.6587 6038.466 -1075.0972 787.26355 -3415.1538 5173.088 2.9452198 2935.6267 4788.3105 12757.299 0.83193994 3799.9436 6144.1387 2574.1113 6925.051 2979.364 2318.922 -4960.787 -564.9072 3211.6936 2829.3965 -5035.106 -1529.861 1441.6108 -468.91583 993.33575 4696.682 -1353.7257 4673.195 2502.2673 2242.7698 5867.2847 10394.185 3986.0254 -1008.35956 -2686.6794 1668.9913 -2000.2214 7846.759 4627.639 -2513.9968 6313.934 900.3209 2854.0537 1512.8761 -1127.5253 3719.4558 -1684.803 7351.4814 1673.6587 3278.0444 4955.3345 -197.21693 1414.0236 -2686.7302 1306.6298 -1527.8574 -497.09 -3145.5344 -1339.5857 -2605.3313 -5026.69 -3492.5159 -1290.7827 -1916.0972 -3248.2766 109.16811 -804.47626 1206.5791 -2959.165 -462.50815 -1941.5826 -2590.9854 -6598.2534 -532.45233 -2210.494 -3375.0015 -1682.6626 -3697.3167 -1567.2506 -1583.9944 1990.3463 -165.42038 -2071.7566 -1796.9664 1853.9702 287.2974 -1166.847 -362.54758 -911.8543 -2590.491 216.81447 -2721.4436 -1620.796 -1528.8453 -3322.2122 -5360.238 -2323.914 20.857443 808.6718 -1267.5492 425.7561 -4406.527 -2631.856 646.65607 -3521.4314 -912.5014 -1793.1174 -1207.9032 23.12927 -2292.8962 338.54852 -4131.4785 -1373.2422 -2253.2617 -2573.3494 -1884.9999 -2090.762 244.5359 -2236.6528 -347.66174 -2121.9893 700.86847 -576.41534 36.710556 2276.633 836.2268 -547.9968 -672.75 -400.96365 -1787.0833 -1145.4254 -2082.7634 924.4451 -1517.6788 -1507.5203 -1040.7509 1338.2836 -1423.7112 -971.99866 948.81805 -613.57776 1119.0498 -1141.4166 -1485.6024 -3076.0313 -1904.5631 345.81 -498.822 -2509.4343 -2342.674 -777.5469 -675.8111 -1332.0277 -1626.1699 -2404.487 -1060.7084 -1864.7625 -1375.2767 832.7989 930.2477 -262.4791 -1362.897 -2410.3616 -812.2048 -2032.9696 2231.2732 -898.41223 -1444.952 298.03586 -840.9898 -1062.4321 -777.184 -957.0704 206.46222 -1526.7145 837.91064 -869.9062 1075.8522 -1585.884 -583.67834 -4623.8315 4756.9404 -4132.4043 2272.48 230.417 5762.5737 1819.085 4657.306 10100.824 6670.92 1816.1354 3032.8542 6221.104 -1162.8992 797.30835 -3614.8188 5481.892 -56.838 2864.3584 4873.501 13295.301 -111.29596 3878.3997 6455.4063 2678.9504 7298.7817 2931.8904 2269.6882 -5274.178 -655.1844 3384.5034 2952.3613 -5453.245 -1716.7563 1483.665 -566.1344 995.3832 4632.3076 -1517.2489 4728.84 2386.3633 2222.4355 6147.183 10815.639 4162.1797 -1099.3607 -2923.9993 1716.7338 -2236.1306 8224.042 4713.7993 -2713.612 6543.23 916.80035 2904.9854 1551.7501 -1199.7522 3902.563 -1803.1179 7642.478 1629.1875 3381.1453 4898.3696|-1767.2852 -765.8234 1416.7736 -1361.5023 -473.9444 646.5363 -320.89874 -334.4061 -334.10278 655.4251 626.9563 637.5872 1531.5703 -1225.0167 -861.87213 1558.3776#D|8|16|61.015972 199.95682 -531.361 -139.64105 -7279.3955 -2000.8005 -6822.0366 -6325.4487 -6175.613 -1980.7633 -1721.5295 -2355.001 -480.11987 27.473238 636.92474 -464.85065 70.30907 -280.60504 -475.42935 1560.1306 -3863.371 -500.9281 -4976.2583 -5438.8804 -4267.265 -554.3746 -1084.3566 -1189.8561 -579.86285 9.960034 -609.0448 -719.7985 63.146584 225.98735 -304.81506 1137.6646 2964.08 -4804.532 2749.2136 2121.9663 2221.4734 -4848.776 -5278.5186 -4361.6836 -341.46924 4.495894 1825.455 -366.69806 -65.40044 492.11996 -568.1153 -1284.0792 -9543.204 -490.94754 -7826.3887 -7414.548 -6944.325 -550.8863 -534.728 -781.7669 -551.1389 -6.602602 -1387.9742 -658.0917 46.69433 176.69057 -505.76517 1827.8402 -4845.8325 -890.7592 -4958.8955 -5284.18 -4337.986 -1018.4233 -979.9337 -1591.584 -585.8702 13.253323 -757.6528 -677.0679 -62.779587 345.84323 -186.88889 -1896.9493 -8832.431 -1801.5967 -8308.219 -8874.081 -8710.004 -1871.1113 -1613.8362 -2370.697 -320.0395 -2.3205678 -287.8058 -499.98218 -47.603848 389.75116 -262.15897 -553.285 -7845.2153 -2000.3148 -6756.257 -7961.7207 -7661.119 -2012.7599 -2026.5452 -2484.2815 -363.8274 -1.5610011 399.83255 -503.30817 69.776344 243.83115 -172.12973 1961.6934 -522.7905 -2506.102 -2488.3882 -2361.2927 -2383.4849 -2452.305 -2701.0364 -2223.3845 -153.91064 10.531645 243.46236 -203.24048|-556.52405 -649.9605 -245.25078 -699.11255 -662.0033 -497.36987 -468.2968 -421.38245#D|1|8|39.18262 0.66158324 -1.9705776 8.496741 20.830534 0.05875416 1.472993 16.468168|1.1385818";


    let mut model_test = Network::deserialize_unda_fmt_string(model_str.into());
    let begin = Instant::now();
    model_test.predict(&vec![0.0,0.0,0.0]);
    let end = Instant::now().duration_since(begin);
    println!("{}", end.as_micros());
}


